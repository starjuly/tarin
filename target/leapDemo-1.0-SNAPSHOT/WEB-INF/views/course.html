<!DOCTYPE HTML>
<html lang="en-US">

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <title>课程</title>
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <link rel="stylesheet" href="../../commons/font-awesome-4.7.0/css/font-awesome.css" />
    <link rel="stylesheet" href="../../public/css/bui.css" />
    <link rel="stylesheet" href="../../public/css/style.css" />
    <!-- 依赖库 手机调试的js引用顺序如下 -->
    <script src="../../commons/angularJs/angular.min.js"></script>
    <script src="../../public/js/zepto.js"></script>
    <script src="../../public/js/cordova.js"></script>
    <script src="../../public/js/bingotouch.js"></script>
    <script src="../../public/js/plugins/fastclick.js"></script>
    <!-- BUI库 -->
    <script src="../../public/js/bui.js"></script>
    <script src="../../public/js/app/_config.js"></script>
</head>

<body>

<div ng-app="myApp" ng-controller="httCtrl">
    <div class="bui-page">
        <header class="bui-bar">
            <div class="bui-bar-left">
                <!-- 左边按钮 -->
                <!--<a class="bui-btn" onclick="bui.back();"><i class="icon-back"></i></a>-->
            </div>
            <div class="bui-bar-main">课程列表</div>
            <div class="bui-bar-right">
                <!-- 右边按钮 -->
            </div>
        </header>
        <main>
            <!-- 正文内容 -->
            <!--<h3 class="section-title">课程列表</h3>-->
            <!--通过获得后台课程数据循环创建课程目录-->



            <div class="bui-list" ng-repeat="x in datas" >
                <!--修改了onjump以及跳转方法-->
                <div class="bui-btn bui-box" ng-click="onJump(x.courseName,x.courseId)">
                    <img src="../../public/images/{{x.courseName}}.png">
                    <!--<img src="../../public/images/Layer-0.png">-->
                </div>
                <div class="bui-btn bui-box clearactive">
                    <div class="bui-label">
                        <label>课程名称</label>
                    </div>
                    <div class="span1">
                        <input id="courseName" type="text" class="bui-input" ng-model="x.courseName">
                    </div>
                    <div class="bui-label" >
                        <label style="float:right; margin-right: 20px">讲师:</label>
                    </div>
                    <div class="span1" >
                        <input  id="teacherName" type="text" class="bui-input" ng-model="x.teacherName">
                    </div>

                </div>

                <div class="bui-btn bui-box clearactive">


                    <div class="bui-label">
                        <label>培训时间</label>
                    </div>
                    <div class="span1">
                        <input id="trainingTime" type="text" class="bui-input" ng-model="x.trainingTime" >
                    </div>

                    <div class="bui-bar-right bui-bar-text" ng-hide="menu" ng-click="onSign(x.courseName,x.signed)">
                        <a class="bui-btn-inline" style="margin-right: 20px" > {{x.signed}}</a>
                    </div>

                    <div class="bui-bar-right bui-bar-text" ng-hide="!menu" ng-click="onMan(x.courseName)">
                        <a class="bui-btn-inline" style="margin-right: 20px" >管理</a>
                    </div>
                </div>
            </div>



           <!-- <div class="bui-list" ng-repeat="x in datas" >

                &lt;!&ndash;修改了onjump以及跳转方法&ndash;&gt;
                <div class="bui-btn bui-box" ng-click="onJump(x.courseName,x.courseId)">
                    <img src="../../public/images/Layer-0.png">
                </div>

             &lt;!&ndash;   <div class="bui-btn bui-box" ng-click="jump('/courseDetail.html')">
                    <img src="../../public/images/Layer-0.png">
                </div>&ndash;&gt;
                <div class="bui-btn bui-box clearactive">
                    <div class="bui-label">
                        <label>课程名称</label>
                    </div>
                    <div class="span1">
                        <input id="courseName" type="text"  class="bui-input" ng-model="x.courseName">
                    </div>
                    <div class="bui-label" >
                        <label style="float:right; margin-right: 20px">讲师:</label>
                    </div>
                    <div class="span1" >
                        <input  id="teacherName" type="text" class="bui-input" ng-model="x.teacherName">
                    </div>

                </div>

                <div class="bui-btn bui-box clearactive">


                    <div class="bui-label">
                        <label>培训时间</label>
                    </div>
                    <div class="span1">
                        <input id="trainingTime" type="text" class="bui-input" ng-model="x.trainingTime" >
                    </div>

                    &lt;!&ndash;<div class="bui-bar-right bui-bar-text" ng-click="onSign(x.courseName)">
                        <a class="bui-btn-inline" style="margin-right: 20px">报名</i></a>
                    </div>&ndash;&gt;
                    <div class="bui-bar-right bui-bar-text" ng-click="onSign(x.courseName,x.signed)">
                        <a class="bui-btn-inline" style="margin-right: 20px" > {{x.signed}}</a>
                    </div>
                </div>
            </div>-->



        </main>
        <footer>
            <!-- 底部内容 -->
            <ul class="bui-nav bui-fluid">
                <!--学生 三栏-->
                <li class="bui-btn bui-box-vertical span4" ng-click="jump('course.html')" ng-hide="menu"><i class="fa fa-book" ></i>
                    <div class="span1">课程</div>
                </li>
               <!-- <li class="bui-btn bui-box-vertical span4" ng-click="jump('showSignCourse.html')" ng-hide="menu"><i class="fa fa-bookmark" ></i>
                    <div class="span1">已报课程信息</div>
                </li>-->
                <li class="bui-btn bui-box-vertical span4" ng-hide="menu">
                </li>
                <li class="bui-btn bui-box-vertical span4" ng-click="jump('studentInfo')" ng-hide="menu"><i class="fa fa-info-circle" ></i>
                    <div class="span1">个人信息</div>
                </li>
                <!--管理员 四栏-->
                <li class="bui-btn bui-box-vertical span3" ng-click="jump('course.html')" ng-hide="!menu"><i class="icon-home" ></i>
                    <div class="span1">课程</div>
                </li>
                <li class="bui-btn bui-box-vertical span3" ng-click="jump('addCourse.html')" ng-hide="!menu"><i class="fa fa-plus" ></i>
                    <div class="span1" >添加课程</div>
                </li>
                <!-- 在jump中添加需要跳转的路径-->
                <li class="bui-btn bui-box-vertical span3" ng-click="jump('remind.html')" ng-hide="!menu"><i class="fa fa-clock-o" ></i>
                    <div class="span1" >提醒</div>
                </li>
                <li class="bui-btn bui-box-vertical span3" ng-click="jump('adminInfo.html')" ng-hide="!menu"><i class="fa fa-info-circle" ></i>
                    <div class="span1">个人信息</div>
                </li>

            </ul>
        </footer>
    </div>
</div>
<script>
    var app = angular.module('myApp', []);
    app.controller('httCtrl', function($scope, $http) {
        //查询角色
        $http.get("/course/query_role")
            .then(function (response){
                $scope.role = response.data;
                if ($scope.role=="0"){
                    $scope.menu=true;

                }else {
                    $scope.menu=false;
                }
            });

        $http.get("/course/query_all_course")
            .then(function (response) {
                $scope.datas = response.data;
            });
        $scope.onSign = function (courseName, signed) {
            if (signed=="报名") {
                $http.get("/course/course_enroll", {
                    params: {
                        "courseName": courseName
                    }
                }).then(function (response) {
                    $scope.status = response.data.status;
                });
                window.location = '/baomingSuccess.html';
            }
            else {
                $http.get("/course/un_sign", {
                    params: {
                        "courseName": courseName
                    }
                }).then(function (response) {
                });
                window.location = '/course.html';
            }
        }

        $scope.jump = function (url) {
            window.location = url;
        }
        //新增方法
        $scope.onJump = function (courseName,courseId) {
            $http.get("/course/on_jump", {
                params: {
                    "courseName": courseName,
                    "courseId" : courseId
                }
            }).then(function (response) {
            });
            window.location = '/courseDetail.html?courseId='+courseId;
        }


        //管理
        $scope.onMan = function (courseName) {
            $http.get("/course/on_jump", {
                params: {
                    "courseName": courseName
                }
            }).then(function (response) {
            });
            window.location = '/courseManage.html';
        }
    });

    
</script>
</body>

</html>